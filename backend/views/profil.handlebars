<div class="row">
  <div class="col">
    <h1>Hallo, {{benutzername}}!</h1>
  </div>
</div>

<!-- Hier sollen die eigenen Touren vom Nutzer gerendert werden -->
<!-- Füge hier deinen Code ein -->

<div class="row">
  <div class="col">
    <a href="/logout" class="btn btn-primary">Logout</a>
  </div>
</div>

<!-- Button und Zielcontainer für das Formular -->
<div class="row mt-3">
  <div class="col">
    <div x-data="{ showForm: false }">
      <button class="btn btn-danger" x-show="!showForm" @click="showForm = true">Account löschen</button>
      <!-- Formular, das an eine andere Stelle im DOM teleportiert wird -->
      <template x-if="showForm">
        <form x-teleport="#form-ziel" action="/account-loeschen" method="post" class="mt-3">
          <div class="form-group">
            <input type="text" class="form-control" name="benutzername" placeholder="Benutzername">
          </div>
          <button type="submit" class="btn btn-danger">Account löschen</button>
        </form>
      </template>
    </div>
  </div>
</div>

{{> tour-erstellen}}
<div class="row">
  <div class="col">
    <h2>Meine Touren</h2>
    {{#if touren}}
    <ul class="list-group">
      {{#each touren}}
      <li class="list-group-item">
        <h3 style="font-size: 20px; padding: 0; margin: 0;">{{this.name}}</h3>
        <br />
        <span>{{this.beschreibung}}</span>
        <br />
        <button class="btn btn-info"><a class="btn-link" href="/tour/{{this.id}}">Starten</a></button>
        <button class="btn btn-primary"><a class="btn-link" href="/tour-bearbeiten/{{this.id}}">Bearbeiten</a></button>
        <button class="btn btn-danger"><a data-tour-id="{{this.id}}" class="btn-link"
            onclick="tourLoeschen(this)">Löschen</a></button>
      </li>
      {{/each}}
    </ul>
    {{else}}
    <p>Du hast noch keine Touren erstellt.</p>
    {{/if}}
  </div>
</div>


<div class="row mt-3">
  <div class="col">
    <h2>Meine geplanten Touren</h2>
    <p>Kommt später</p>
    <!-- Füge hier deinen Code ein -->
    <!-- folgt. -->
  </div>
</div>

<div id="form-ziel"></div>

<script>
  function tourLoeschen(button) {
    // POST request an den Server zur loeschung 
    fetch('/tour-loeschen', {
      method: 'POST',
      headers: {
        'Content-Type': 'application/json',
      },
      body: JSON.stringify({
        tourId: button.getAttribute('data-tour-id')
      }),
    })
      .then((res) => res.json())
      .then((data) => {
        console.log('Erfolgreich:', data)
        // Seite neu laden
        window.location.reload()
      })
  }
</script>